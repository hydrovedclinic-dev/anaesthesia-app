<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Anaesthesia Receipt</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  font-family: Arial, Helvetica, sans-serif;
  background:#f4f6f9;
  margin:0;
}
.header{
  background:#0d6efd;
  color:white;
  padding:14px;
  text-align:center;
  font-size:18px;
  font-weight:bold;
}
.container{ padding:14px; }
.card{
  background:white;
  padding:14px;
  border-radius:10px;
  box-shadow:0 2px 6px rgba(0,0,0,0.15);
  margin-bottom:14px;
}
label{ font-weight:bold; display:block; margin-top:10px; }
input, textarea{
  width:100%;
  padding:8px;
  margin-top:4px;
  border-radius:6px;
  border:1px solid #ccc;
  font-size:14px;
}
button{
  width:100%;
  padding:10px;
  margin-top:12px;
  border:none;
  border-radius:8px;
  background:#198754;
  color:white;
  font-size:15px;
  font-weight:bold;
}
button.print{ background:#0d6efd; }
button.whatsapp{ background:#25D366; }

/* ===== PRINT ===== */
@media print{
  body{ margin:12mm; background:white; font-size:12px; color:black; }
  button{ display:none !important; }
  .header{ display:none; }
}
</style>
</head>

<body>

<div class="header">üè• Anaesthesia Receipt System</div>

<div class="container">

<!-- ===== INPUT ===== -->
<div class="card">
  <label>Hospital Name</label>
  <input id="hospital" value="Hydroved Clinic">

  <label>Hospital Address</label>
  <textarea id="hospitalAddr">Kolhapur, Maharashtra</textarea>

  <label>Hospital Logo</label>
  <input type="file" accept="image/*" onchange="loadLogo(event)">

  <label>Patient Name</label>
  <input id="patient">

  <label>Procedure</label>
  <input id="procedure">

  <label>Anaesthetist Name</label>
  <input id="doctor">

  <label>Anaesthetist Reg No</label>
  <input id="regno">

  <label>Amount (‚Çπ)</label>
  <input id="amount" type="number">

  <button onclick="generateReceipt()">Generate Receipt</button>
</div>

<!-- ===== RECEIPT ===== -->
<div class="card" id="receiptCard" style="display:none;">
  <div id="receiptArea">

    <div style="text-align:center;">
      <img id="r_logo" style="max-height:80px;"><br>
      <strong id="r_hospital"></strong><br>
      <span id="r_addr" style="font-size:11px;"></span>
    </div>

    <hr>

    <p><strong>Receipt No:</strong> <span id="r_serial"></span></p>
    <p><strong>Date:</strong> <span id="r_date"></span></p>

    <hr>

    <p><strong>Patient:</strong> <span id="r_patient"></span></p>
    <p><strong>Procedure:</strong> <span id="r_procedure"></span></p>
    <p><strong>Anaesthetist:</strong> <span id="r_doctor"></span></p>
    <p><strong>Reg No:</strong> <span id="r_regno"></span></p>

    <hr>

    <p><strong>Amount:</strong> ‚Çπ <span id="r_amount"></span></p>
    <p><strong>Amount in Words:</strong> <span id="r_words"></span></p>

    <div style="text-align:center;margin-top:15px;">
      <img id="qr" alt="QR Code">
    </div>

    <p style="text-align:center;font-size:10px;margin-top:10px;">
      Computer generated receipt ‚Äì No signature required
    </p>

  </div>

  <button class="print" onclick="printReceipt()">üñ®Ô∏è Print / Save as PDF</button>
  <button class="whatsapp" onclick="shareWhatsApp()">üì≤ Share on WhatsApp</button>
</div>

</div>

<script>
let logoData = "";

/* ===== LOGO ===== */
function loadLogo(e){
  const reader = new FileReader();
  reader.onload = ()=> logoData = reader.result;
  reader.readAsDataURL(e.target.files[0]);
}

/* ===== SERIAL ===== */
function getNextSerial(){
  let s = localStorage.getItem("receiptSerial");
  s = s ? parseInt(s)+1 : 1;
  localStorage.setItem("receiptSerial", s);
  return "AR-"+String(s).padStart(5,"0");
}

/* ===== AMOUNT WORDS ===== */
function numberToWords(n){
  const a=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten",
  "Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"];
  const b=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];
  function w(x){
    if(x<20) return a[x];
    if(x<100) return b[Math.floor(x/10)]+" "+a[x%10];
    if(x<1000) return a[Math.floor(x/100)]+" Hundred "+w(x%100);
    if(x<100000) return w(Math.floor(x/1000))+" Thousand "+w(x%1000);
    if(x<10000000) return w(Math.floor(x/100000))+" Lakh "+w(x%100000);
    return w(Math.floor(x/10000000))+" Crore "+w(x%10000000);
  }
  return w(n).trim()+" Rupees Only";
}

/* ===== GENERATE ===== */
function generateReceipt(){
  const amt = parseInt(amount.value||0);
  r_hospital.innerText = hospital.value;
  r_addr.innerText = hospitalAddr.value;
  r_patient.innerText = patient.value;
  r_procedure.innerText = procedure.value;
  r_doctor.innerText = doctor.value;
  r_regno.innerText = regno.value;
  r_amount.innerText = amt;
  r_words.innerText = numberToWords(amt);
  r_date.innerText = new Date().toLocaleDateString();
  r_serial.innerText = getNextSerial();
  if(logoData) r_logo.src = logoData;

  const qrText =
    "Receipt:"+r_serial.innerText+
    ", Patient:"+patient.value+
    ", Amount:"+amt;

  qr.src =
    "https://api.qrserver.com/v1/create-qr-code/?size=120x120&data="+
    encodeURIComponent(qrText);

  receiptCard.style.display="block";
}

/* ===== PRINT ===== */
function printReceipt(){
  const r = receiptArea.innerHTML;
  const o = document.body.innerHTML;
  document.body.innerHTML = r;
  window.print();
  document.body.innerHTML = o;
  location.reload();
}

/* ===== WHATSAPP ===== */
function shareWhatsApp(){
  const text =
    "Receipt "+r_serial.innerText+
    "\nPatient: "+r_patient.innerText+
    "\nAmount: ‚Çπ"+r_amount.innerText+
    "\nThank you.";
  window.open("https://wa.me/?text="+encodeURIComponent(text));
}
</script>

</body>
</html>
